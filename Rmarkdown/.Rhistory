select(-volume_2010)
clean_demand_gdp_capita <-
dsets[["portugal_gdp_per_capita"]] %>%
filter(Year >= 2010 & Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(gdp_capita = GDP.per.capita..PPP..constant.2017.international...) %>%
mutate(capita_2010 = gdp_capita[Year == 2010],
i_gdp_capita_2010 = gdp_capita/capita_2010) %>%
select(-capita_2010)
clean_gdp_capita_volumes <-
clean_gdp_capita_volumes %>%
merge(., clean_demand_gdp_capita, by = "Year") %>%
filter(Year >= 2011, Year <= 2024)
temp <-
list(clean_gdp_capita_volumes[, c("Year", "total_vol", "i_tot_vol_2010")],
clean_gdp_capita_volumes[, c("Year", "gdp_capita", "i_gdp_capita_2010")])
View(temp)
highchart() %>%
hc_add_series(
data = temp[[1]],
type = "line",
hcaes(x = Year, y = i_tot_vol_2010),
name = "Snack Volume Variation"
) %>%
hc_add_series(
data = temp[[2]],
type = "line",
hcaes(x = Year, y = i_gdp_capita_2010),
name = "GDP per Capita Variation"
) %>%
hc_title(text = "Combined Line Chart of Two Datasets") %>%
hc_xAxis(title = list(text = "Year")) %>%
hc_yAxis(title = list(text = "Values")) %>%
hc_tooltip(shared = TRUE)
# Chunk 1: SETUP
#GENERAL CODE CHUNK SETUP
knitr::opts_chunk$set(echo = FALSE, message=FALSE)
#+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-#
#PACKAGE INSTALLATION AND LOADING
#-the essential packages required to load the document are markdown, knitr, flexdashboard and pacman.
#-the following code checks for their installation, installing them if required, and proceeds
#-to install/load other necessary packages.
if(!require("markdown")) install.packages("markdown")
if(!require("knitr")) install.packages("knitr")
if(!require("flexdashboard")) install.packages("flexdashboard")
if(!require("pacman")) install.packages("pacman")
#--pacman function essential for loading and installing (if not already installed) packages together
pacman::p_load(
knitr,           #--essential for rmarkdown document modification
tidyverse,       #--contains ggplot2, readr, tibble, dplyr, magrittr
reactable,       #--for creation of large tables
janitor,         #--manipulation, summarisation of messy data, plus duplicate detection
inspectdf,       #--dataframe inspection, relative to value (used in dataset analysis)
highcharter,     #--interactive data visualisation
htmltools,       #--website page options (zoom, scrolling)
collapsibleTree, #--for happiness factor collapsible tree
broom,           #--needed to convert linear model for interpolation line into dataframe
dygraphs,        #--package for time series model creation
xts,             #--data format required by dygraphs
shiny,           #--"runtime: shiny" in JMAL header already loads the library, useful for debugging w/o                       knitting
shinyWidgets,    #--additional customisation for shiny elements
readxl,
viridis
)
#FUNCTIONS
#-".csv" extension remover, for variable list
ext_remove <-
function(x){
substr(x, 1, nchar(x)-4)
}
xls_remove <-
function(x){
substr(x, 1, nchar(x)-5)
}
#-----#
#HIGHCHARTER LINE CHART FORMAT
lnplot_custom <- function(x){
x %>%
hc_title(style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_size(width = NULL, height = 350) %>%
hc_yAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_xAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>
Year: {point.x:.f}<br>Population: {point.y:.f}") %>%
hc_plotOptions(.,line=list(color="#db240c"))
}
#-----#
#HIGHCHARTER() BAR PLOT FORMAT
barplot_custom <- function(x){
x %>%
hc_title(style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_size(width = NULL, height = 450) %>%
hc_yAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_xAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_tooltip(shared = TRUE, crosshairs = TRUE, sort = TRUE)
}
#+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-#
#DATA IMPORTING
#when downloading the file, the working directory should automatically set to the path where the Markdown file is saved. if that does not occur, copy the Markdown from the dropdown menu between the "" and run the single line of code.
setwd("C:/Users/busop/All Files - ORIGINAL FILES OF DESKTOP LINKS/Github/market-analysis-2024-2025/Rmarkdown")
dsets <- list.files(path="./Datasets", pattern = "*.csv", full.names = FALSE)
#vector with file names
dsets <-
#assign the value contained in each dataset to its respective name
setNames(
lapply(list.files(path= "./Datasets", pattern="*.csv", full.names = TRUE), read.csv),
#reading each csv file, same code as dsets w/ exception that it takes full file path rather than just the name
lapply(dsets, ext_remove)
#removing ".csv" file extension to create variable list, function above
)
#same concept reapplied for xlsx files, useful to separate the two
xlsx_dsets <- list.files(path="./Datasets", pattern = "*.xlsx", full.names = TRUE)
xlsx_dsets <-
setNames(
lapply(xlsx_dsets, read_xlsx),
lapply(list.files(path="./Datasets", pattern = "*.xlsx", full.names = FALSE), xls_remove)
)
#final dsets vectors contains variables associated w/ respective dataset:
#-global edits done to reduce variable names, since discarded data not required.
#-method flexible to increases, decreases or variations in order to dataset directory.
clean_gdp_capita_volumes <-
xlsx_dsets[["portugal_retail_volume_price"]] %>%
filter(`Data Type` == "Retail Volume (Tonnes)", Geography != "World") %>%
select(-Geography, -`Data Type`, -Unit, -`Current Constant P`) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "Value") %>%
group_by(Year) %>%
summarise(total_vol = sum(Value)) %>%
mutate(volume_2010 = total_vol[Year == 2010],
i_tot_vol_2010 = total_vol/volume_2010) %>%
ungroup() %>%
select(-volume_2010)
View(clean_gdp_capita_volumes)
clean_demand_gdp_capita <-
dsets[["portugal_gdp_per_capita"]] %>%
filter(Year >= 2010 & Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(gdp_capita = GDP.per.capita..PPP..constant.2017.international...) %>%
mutate(capita_2010 = gdp_capita[Year == 2010],
i_gdp_capita_2010 = gdp_capita/capita_2010) %>%
select(-capita_2010)
View(clean_demand_gdp_capita)
clean_gdp_capita_volumes <-
clean_gdp_capita_volumes %>%
merge(., clean_demand_gdp_capita, by = "Year")
clean_gdp_capita_volumes <-
clean_gdp_capita_volumes %>%
merge(., clean_demand_gdp_capita, by = "Year") %>%
filter(Year >= 2011, Year <= 2024)
temp <-
list(clean_gdp_capita_volumes[, c("Year", "total_vol", "i_tot_vol_2010")],
clean_gdp_capita_volumes[, c("Year", "gdp_capita", "i_gdp_capita_2010")])
clean_gdp_capita_volumes <-
xlsx_dsets[["portugal_retail_volume_price"]] %>%
filter(`Data Type` == "Retail Volume (Tonnes)", Geography != "World") %>%
select(-Geography, -`Data Type`, -Unit, -`Current Constant P`) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "Value") %>%
group_by(Year) %>%
summarise(total_vol = sum(Value)) %>%
mutate(volume_2010 = total_vol[Year == 2010],
i_tot_vol_2010 = total_vol/volume_2010) %>%
ungroup() %>%
select(-volume_2010)
clean_demand_gdp_capita <-
dsets[["portugal_gdp_per_capita"]] %>%
filter(Year >= 2010 & Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(gdp_capita = GDP.per.capita..PPP..constant.2017.international...) %>%
mutate(capita_2010 = gdp_capita[Year == 2010],
i_gdp_capita_2010 = gdp_capita/capita_2010) %>%
select(-capita_2010)
clean_gdp_capita_volumes <-
merge(clean_gdp_capita_volumes, clean_demand_gdp_capita, by = "Year") %>%
filter(Year >= 2011, Year <= 2024)
temp <-
list(clean_gdp_capita_volumes[, c("Year", "total_vol", "i_tot_vol_2010")],
clean_gdp_capita_volumes[, c("Year", "gdp_capita", "i_gdp_capita_2010")])
# Chunk 1: SETUP
#GENERAL CODE CHUNK SETUP
knitr::opts_chunk$set(echo = FALSE, message=FALSE)
#+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-#
#PACKAGE INSTALLATION AND LOADING
#-the essential packages required to load the document are markdown, knitr, flexdashboard and pacman.
#-the following code checks for their installation, installing them if required, and proceeds
#-to install/load other necessary packages.
if(!require("markdown")) install.packages("markdown")
if(!require("knitr")) install.packages("knitr")
if(!require("flexdashboard")) install.packages("flexdashboard")
if(!require("pacman")) install.packages("pacman")
#--pacman function essential for loading and installing (if not already installed) packages together
pacman::p_load(
knitr,           #--essential for rmarkdown document modification
tidyverse,       #--contains ggplot2, readr, tibble, dplyr, magrittr
reactable,       #--for creation of large tables
janitor,         #--manipulation, summarisation of messy data, plus duplicate detection
inspectdf,       #--dataframe inspection, relative to value (used in dataset analysis)
highcharter,     #--interactive data visualisation
htmltools,       #--website page options (zoom, scrolling)
collapsibleTree, #--for happiness factor collapsible tree
broom,           #--needed to convert linear model for interpolation line into dataframe
dygraphs,        #--package for time series model creation
xts,             #--data format required by dygraphs
shiny,           #--"runtime: shiny" in JMAL header already loads the library, useful for debugging w/o                       knitting
shinyWidgets,    #--additional customisation for shiny elements
readxl,
viridis
)
#FUNCTIONS
#-".csv" extension remover, for variable list
ext_remove <-
function(x){
substr(x, 1, nchar(x)-4)
}
xls_remove <-
function(x){
substr(x, 1, nchar(x)-5)
}
#-----#
#HIGHCHARTER LINE CHART FORMAT
lnplot_custom <- function(x){
x %>%
hc_title(style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_size(width = NULL, height = 350) %>%
hc_yAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_xAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>
Year: {point.x:.f}<br>Population: {point.y:.f}") %>%
hc_plotOptions(.,line=list(color="#db240c"))
}
#-----#
#HIGHCHARTER() BAR PLOT FORMAT
barplot_custom <- function(x){
x %>%
hc_title(style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_size(width = NULL, height = 450) %>%
hc_yAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_xAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_tooltip(shared = TRUE, crosshairs = TRUE, sort = TRUE)
}
#+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-#
#DATA IMPORTING
#when downloading the file, the working directory should automatically set to the path where the Markdown file is saved. if that does not occur, copy the Markdown from the dropdown menu between the "" and run the single line of code.
setwd("C:/Users/busop/All Files - ORIGINAL FILES OF DESKTOP LINKS/Github/market-analysis-2024-2025/Rmarkdown")
dsets <- list.files(path="./Datasets", pattern = "*.csv", full.names = FALSE)
#vector with file names
dsets <-
#assign the value contained in each dataset to its respective name
setNames(
lapply(list.files(path= "./Datasets", pattern="*.csv", full.names = TRUE), read.csv),
#reading each csv file, same code as dsets w/ exception that it takes full file path rather than just the name
lapply(dsets, ext_remove)
#removing ".csv" file extension to create variable list, function above
)
#same concept reapplied for xlsx files, useful to separate the two
xlsx_dsets <- list.files(path="./Datasets", pattern = "*.xlsx", full.names = TRUE)
xlsx_dsets <-
setNames(
lapply(xlsx_dsets, read_xlsx),
lapply(list.files(path="./Datasets", pattern = "*.xlsx", full.names = FALSE), xls_remove)
)
#final dsets vectors contains variables associated w/ respective dataset:
#-global edits done to reduce variable names, since discarded data not required.
#-method flexible to increases, decreases or variations in order to dataset directory.
clean_gdp_capita_volumes <-
xlsx_dsets[["portugal_retail_volume_price"]] %>%
filter(`Data Type` == "Retail Volume (Tonnes)", Geography != "World") %>%
select(-Geography, -`Data Type`, -Unit, -`Current Constant P`) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "Value") %>%
group_by(Year) %>%
summarise(total_vol = sum(Value)) %>%
mutate(volume_2010 = total_vol[Year == 2010],
i_tot_vol_2010 = total_vol/volume_2010) %>%
ungroup() %>%
select(-volume_2010)
View(clean_gdp_capita_volumes)
clean_demand_gdp_capita <-
dsets[["portugal_gdp_per_capita"]] %>%
filter(Year >= 2010 & Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(gdp_capita = GDP.per.capita..PPP..constant.2017.international...) %>%
mutate(capita_2010 = gdp_capita[Year == 2010],
i_gdp_capita_2010 = gdp_capita/capita_2010) %>%
select(-capita_2010)
View(clean_demand_gdp_capita)
clean_gdp_capita_volumes <-
merge(clean_gdp_capita_volumes, clean_demand_gdp_capita, by = "Year")
clean_gdp_capita_volumes <-
merge(clean_gdp_capita_volumes, clean_demand_gdp_capita, by = "Year") %>%
filter(Year >= 2011, Year <= 2024)
# Chunk 1: SETUP
#GENERAL CODE CHUNK SETUP
knitr::opts_chunk$set(echo = FALSE, message=FALSE)
#+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-#
#PACKAGE INSTALLATION AND LOADING
#-the essential packages required to load the document are markdown, knitr, flexdashboard and pacman.
#-the following code checks for their installation, installing them if required, and proceeds
#-to install/load other necessary packages.
if(!require("markdown")) install.packages("markdown")
if(!require("knitr")) install.packages("knitr")
if(!require("flexdashboard")) install.packages("flexdashboard")
if(!require("pacman")) install.packages("pacman")
#--pacman function essential for loading and installing (if not already installed) packages together
pacman::p_load(
knitr,           #--essential for rmarkdown document modification
tidyverse,       #--contains ggplot2, readr, tibble, dplyr, magrittr
reactable,       #--for creation of large tables
janitor,         #--manipulation, summarisation of messy data, plus duplicate detection
inspectdf,       #--dataframe inspection, relative to value (used in dataset analysis)
highcharter,     #--interactive data visualisation
htmltools,       #--website page options (zoom, scrolling)
collapsibleTree, #--for happiness factor collapsible tree
broom,           #--needed to convert linear model for interpolation line into dataframe
dygraphs,        #--package for time series model creation
xts,             #--data format required by dygraphs
shiny,           #--"runtime: shiny" in JMAL header already loads the library, useful for debugging w/o                       knitting
shinyWidgets,    #--additional customisation for shiny elements
readxl,
viridis
)
#FUNCTIONS
#-".csv" extension remover, for variable list
ext_remove <-
function(x){
substr(x, 1, nchar(x)-4)
}
xls_remove <-
function(x){
substr(x, 1, nchar(x)-5)
}
#-----#
#HIGHCHARTER LINE CHART FORMAT
lnplot_custom <- function(x){
x %>%
hc_title(style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_size(width = NULL, height = 350) %>%
hc_yAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_xAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>
Year: {point.x:.f}<br>Population: {point.y:.f}") %>%
hc_plotOptions(.,line=list(color="#db240c"))
}
#-----#
#HIGHCHARTER() BAR PLOT FORMAT
barplot_custom <- function(x){
x %>%
hc_title(style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_size(width = NULL, height = 450) %>%
hc_yAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_xAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_tooltip(shared = TRUE, crosshairs = TRUE, sort = TRUE)
}
#+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-#
#DATA IMPORTING
#when downloading the file, the working directory should automatically set to the path where the Markdown file is saved. if that does not occur, copy the Markdown from the dropdown menu between the "" and run the single line of code.
setwd("C:/Users/busop/All Files - ORIGINAL FILES OF DESKTOP LINKS/Github/market-analysis-2024-2025/Rmarkdown")
dsets <- list.files(path="./Datasets", pattern = "*.csv", full.names = FALSE)
#vector with file names
dsets <-
#assign the value contained in each dataset to its respective name
setNames(
lapply(list.files(path= "./Datasets", pattern="*.csv", full.names = TRUE), read.csv),
#reading each csv file, same code as dsets w/ exception that it takes full file path rather than just the name
lapply(dsets, ext_remove)
#removing ".csv" file extension to create variable list, function above
)
#same concept reapplied for xlsx files, useful to separate the two
xlsx_dsets <- list.files(path="./Datasets", pattern = "*.xlsx", full.names = TRUE)
xlsx_dsets <-
setNames(
lapply(xlsx_dsets, read_xlsx),
lapply(list.files(path="./Datasets", pattern = "*.xlsx", full.names = FALSE), xls_remove)
)
#final dsets vectors contains variables associated w/ respective dataset:
#-global edits done to reduce variable names, since discarded data not required.
#-method flexible to increases, decreases or variations in order to dataset directory.
clean_gdp_capita_volumes <-
xlsx_dsets[["portugal_retail_volume_price"]] %>%
filter(`Data Type` == "Retail Volume (Tonnes)", Geography != "World") %>%
select(-Geography, -`Data Type`, -Unit, -`Current Constant P`) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "Value") %>%
group_by(Year) %>%
summarise(total_vol = sum(Value)) %>%
mutate(volume_2010 = total_vol[Year == 2010],
i_tot_vol_2010 = total_vol/volume_2010) %>%
ungroup() %>%
select(-volume_2010)
clean_demand_gdp_capita <-
dsets[["portugal_gdp_per_capita"]] %>%
filter(Year >= 2010 & Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(gdp_capita = GDP.per.capita..PPP..constant.2017.international...) %>%
mutate(capita_2010 = gdp_capita[Year == 2010],
i_gdp_capita_2010 = gdp_capita/capita_2010) %>%
select(-capita_2010)
clean_gdp_capita_volumes <-
merge(clean_gdp_capita_volumes, clean_demand_gdp_capita, by = "Year") %>%
filter(Year >= 2011, Year <= 2024)
View(clean_gdp_capita_volumes)
temp <-
list(clean_gdp_capita_volumes[, c("Year", "total_vol", "i_tot_vol_2010")],
clean_gdp_capita_volumes[, c("Year", "gdp_capita", "i_gdp_capita_2010")])
highchart() %>%
hc_add_series(
data = temp[[1]],
type = "line",
hcaes(x = Year, y = i_tot_vol_2010),
name = "Snack Volume Variation"
) %>%
hc_add_series(
data = temp[[2]],
type = "line",
hcaes(x = Year, y = i_gdp_capita_2010),
name = "GDP per Capita Variation"
) %>%
hc_title(text = "Combined Line Chart of Two Datasets") %>%
hc_xAxis(title = list(text = "Year")) %>%
hc_yAxis(title = list(text = "Values")) %>%
hc_tooltip(shared = TRUE)
