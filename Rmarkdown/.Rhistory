clean_hdi
clean_poverty_percentage <-
dsets[["portugal_population_poverty"]] %>%
filter(Year >= 1800 & Entity == "Portugal" & Year <= 2023) %>%
select(-Code, -Entity) %>%
rename(`Poverty Ratio` = Poverty.headcount.ratio.at.national.poverty.lines....of.population.) %>%
hchart("line", hcaes(`Year`, `Poverty Ratio`)) %>%
hc_title(text = "Portuguese Relative Population Poverty Percentage [%]") %>%
hc_yAxis(title = list(text = "<b>National Poverty Headcount Ratio</b>", align = "middle")) %>%
hc_xAxis(title = list(text = "<b>Year</b>", align = "middle")) %>%
lnplot_custom(.) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Poverty Percentage: {point.y:.1f}%") %>%
hc_caption(
text = "<b>National poverty headcount ratio</b> =  percentage of the population living below the national poverty line(s). <br>National estimates are based on population-weighted subgroup estimates from household surveys.",
style = list(marginTop = "0px")
)
clean_poverty_percentage
#CLEAN PARALLELS DATASETS
economic_factor_choice <-
c("Nominal GDP", "Consumer Price Index", "Real GDP", "Unemployment Rate", "Inflation Rate")
economics_nom_gdp <-
dsets[["portugal_gdp_constant"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Nominal GDP` = GDP..constant.2015.US..)
economics_cpi <-
dsets[["portugal_consumer_price_index"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Consumer Price Index` = Consumer.price.index..2010...100.)
economics_rgdp <-
merge(economics_nom_gdp, economics_cpi, by = "Year") %>%
mutate(`Real GDP` = (`Nominal GDP`/`Consumer Price Index`)*100) %>%
select(Year, `Real GDP`) %>%
hchart("line", hcaes(`Year`, `Real GDP`)) %>%
hc_title(text = "Portuguese Real GDP") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Real GDP [int $]</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000000) {
return (this.value/1000000000) + ' bil';
} else if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Real GDP: {point.y:.1f} int $") %>%
hc_caption(
text = "<b>Real GDP</b> = value expressing the amount of goods and services that are produced and sold through markets, at a given time, adjusted for constant prices using a deflator, the yearly consumer price index.",
style = list(marginTop = "0px")
)
economics_rgdp
economics_nom_gdp <-
economics_nom_gdp %>%
hchart("line", hcaes(`Year`, `Nominal GDP`)) %>%
hc_title(text = "Portuguese Nominal GDP") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Nominal GDP [int $]</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000000) {
return (this.value/1000000000) + ' bil';
} else if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Nominal GDP: {point.y:.1f} int $") %>%
hc_caption(
text = "<b>Nominal GDP</b> = value expressing the amount of goods and services that are produced and sold through markets, at a given time, calculated using current prices.",
style = list(marginTop = "0px")
)
economics_nom_gdp
economics_rgdp
economics_rgdp <-
merge(economics_nom_gdp, economics_cpi, by = "Year") %>%
mutate(`Real GDP` = (`Nominal GDP`/`Consumer Price Index`)) %>%
select(Year, `Real GDP`) %>%
hchart("line", hcaes(`Year`, `Real GDP`)) %>%
hc_title(text = "Portuguese Real GDP") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Real GDP [int $]</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000000) {
return (this.value/1000000000) + ' bil';
} else if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Real GDP: {point.y:.1f} int $") %>%
hc_caption(
text = "<b>Real GDP</b> = value expressing the amount of goods and services that are produced and sold through markets, at a given time, adjusted for constant prices using a deflator, the yearly consumer price index.",
style = list(marginTop = "0px")
)
economics_nom_gdp <-
dsets[["portugal_gdp_constant"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Nominal GDP` = GDP..constant.2015.US..)
economics_cpi <-
dsets[["portugal_consumer_price_index"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Consumer Price Index` = Consumer.price.index..2010...100.)
economics_rgdp <-
merge(economics_nom_gdp, economics_cpi, by = "Year") %>%
mutate(`Real GDP` = (`Nominal GDP`/`Consumer Price Index`)) %>%
select(Year, `Real GDP`) %>%
hchart("line", hcaes(`Year`, `Real GDP`)) %>%
hc_title(text = "Portuguese Real GDP") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Real GDP [int $]</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000000) {
return (this.value/1000000000) + ' bil';
} else if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Real GDP: {point.y:.1f} int $") %>%
hc_caption(
text = "<b>Real GDP</b> = value expressing the amount of goods and services that are produced and sold through markets, at a given time, adjusted for constant prices using a deflator, the yearly consumer price index.",
style = list(marginTop = "0px")
)
economics_rgdp
economics_cpi <-
dsets[["portugal_consumer_price_index"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Consumer Price Index` = Consumer.price.index..2010...100.)
filter(economics_cpi, `Consumer Price Index` == 100)
economics_rgdp <-
merge(economics_nom_gdp, economics_cpi, by = "Year") %>%
mutate(`Real GDP` = (`Nominal GDP`/`Consumer Price Index`)*100) %>%
select(Year, `Real GDP`) %>%
hchart("line", hcaes(`Year`, `Real GDP`))
economics_rgdp_g_rate <-
economics_rgdp %>%
mutate(`Real GDP Growth Rate` = ((`Real GDP` - lag(`Real GDP`)) / lag(`Real GDP`) * 100))
#CLEAN PARALLELS DATASETS
economic_factor_choice <-
c("Nominal GDP", "Consumer Price Index", "Real GDP", "Unemployment Rate", "Inflation Rate")
economics_nom_gdp <-
dsets[["portugal_gdp_constant"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Nominal GDP` = GDP..constant.2015.US..)
economics_cpi <-
dsets[["portugal_consumer_price_index"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Consumer Price Index` = Consumer.price.index..2010...100.)
economics_rgdp <-
merge(economics_nom_gdp, economics_cpi, by = "Year") %>%
mutate(`Real GDP` = (`Nominal GDP`/`Consumer Price Index`)*100) %>%
select(Year, `Real GDP`) %>%
hchart("line", hcaes(`Year`, `Real GDP`))
economics_rgdp_g_rate <-
economics_rgdp %>%
mutate(`Real GDP Growth Rate` = ((`Real GDP` - lag(`Real GDP`)) / lag(`Real GDP`) * 100))
economics_rgdp <-
merge(economics_nom_gdp, economics_cpi, by = "Year") %>%
mutate(`Real GDP` = (`Nominal GDP`/`Consumer Price Index`)*100) %>%
select(Year, `Real GDP`)
economics_rgdp_g_rate <-
economics_rgdp %>%
mutate(`Real GDP Growth Rate` = ((`Real GDP` - lag(`Real GDP`)) / lag(`Real GDP`) * 100))
economics_rgdp_g_rate <-
economics_rgdp %>%
mutate(`Real GDP Growth Rate` = ((`Real GDP` - lag(`Real GDP`)) / lag(`Real GDP`) * 100)) %>%
select(-`Real GDP`)
View(economics_rgdp_g_rate)
#GENERAL CODE CHUNK SETUP
knitr::opts_chunk$set(echo = FALSE, message=FALSE)
#+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-#
#PACKAGE INSTALLATION AND LOADING
#-the essential packages required to load the document are markdown, knitr, flexdashboard and pacman.
#-the following code checks for their installation, installing them if required, and proceeds
#-to install/load other necessary packages.
if(!require("markdown")) install.packages("markdown")
if(!require("knitr")) install.packages("knitr")
if(!require("flexdashboard")) install.packages("flexdashboard")
if(!require("pacman")) install.packages("pacman")
#--pacman function essential for loading and installing (if not already installed) packages together
pacman::p_load(
knitr,           #--essential for rmarkdown document modification
tidyverse,       #--contains ggplot2, readr, tibble, dplyr, magrittr
reactable,       #--for creation of large tables
janitor,         #--manipulation, summarisation of messy data, plus duplicate detection
inspectdf,       #--dataframe inspection, relative to value (used in dataset analysis)
highcharter,     #--interactive data visualisation
htmltools,       #--website page options (zoom, scrolling)
collapsibleTree, #--for happiness factor collapsible tree
broom,           #--needed to convert linear model for interpolation line into dataframe
dygraphs,        #--package for time series model creation
xts,             #--data format required by dygraphs
shiny,           #--"runtime: shiny" in JMAL header already loads the library, useful for debugging w/o                       knitting
shinyWidgets,    #--additional customisation for shiny elements
readxl
)
#FUNCTIONS
#-".csv" extension remover, for variable list
csv_remove <-
function(x){
substr(x, 1, nchar(x)-4)
}
#-----#
xls_remove <-
function(x){
substr(x, 1, nchar(x)-5)
}
#-----#
#HIGHCHARTER() SCATTERPLOT FORMAT
scplot_custom <- function(x){
x %>%
hc_title(style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_size(., width=80, height=310) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>X: {point.x:.1f}%<br>Y: {point.y:.2f}") %>%
hc_yAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}/10"),
lineColor="#ecf0f1") %>%
hc_xAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}%"),
lineColor="#ecf0f1") %>%
hc_plotOptions(., scatter=list(color="#db240c"))
}
#-----#
#HIGHCHARTER LINE CHART FORMAT
lnplot_custom <- function(x){
x %>%
hc_title(style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_size(width = NULL, height = 350) %>%
hc_yAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_xAxis(
type="linear",
lineWidth=5,
labels=list(format="{value}"),
lineColor="#ecf0f1") %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>
Year: {point.x:.f}<br>Population: {point.y:.f}") %>%
hc_plotOptions(.,line=list(color="#db240c"))
}
#+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-#
#DATA IMPORTING
#when downloading the file, the working directory should automatically set to the path where the Markdown file is saved. if that does not occur, copy the Markdown from the dropdown menu between the "" and run the single line of code.
setwd("C:/Users/busop/All Files - ORIGINAL FILES OF DESKTOP LINKS/Github/market-analysis-2024-2025/Rmarkdown")
dsets <- list.files(path="./Datasets", pattern = "*.csv", full.names = FALSE)   #vector with file names
dsets <-
#assign the value contained in each dataset to its respective name
setNames(
lapply(list.files(path= "./Datasets", pattern="*.csv", full.names = TRUE), read.csv),
#reading each csv file, same code as dsets w/ exception that it takes full file path rather than just the name
lapply(dsets, csv_remove)
#removing ".csv" file extension to create variable list, function above
)
xls_dsets <- list.files(path="./Datasets", pattern = "*.xlsx", full.names = FALSE)   #vector with file names
xls_dsets <-
setNames(
lapply(list.files(path="./Datasets", pattern = "*.xlsx", full.names = TRUE), read_excel),
lapply(xls_dsets, xls_remove)
)
#final dsets vector contains variables associated w/ respective dataset:
#-global edits done to reduce variable names, since discarded data not required.
#-method flexible to increases, decreases or variations in order to dataset directory.
#CLEAN PARALLELS DATASETS
economic_factor_choice <-
c("Nominal GDP", "Consumer Price Index", "Real GDP", "Real GDP Growth Rate", "Unemployment Rate", "Inflation Rate")
economics_nom_gdp <-
dsets[["portugal_gdp_constant"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Nominal GDP` = GDP..constant.2015.US..)
economics_cpi <-
dsets[["portugal_consumer_price_index"]] %>%
filter(Entity == "Portugal") %>%
select(-Code, -Entity) %>%
rename(`Consumer Price Index` = Consumer.price.index..2010...100.)
economics_rgdp <-
merge(economics_nom_gdp, economics_cpi, by = "Year") %>%
mutate(`Real GDP` = (`Nominal GDP`/`Consumer Price Index`)*100) %>%
select(Year, `Real GDP`)
economics_rgdp_g_rate <-
economics_rgdp %>%
mutate(`Real GDP Growth Rate` = ((`Real GDP` - lag(`Real GDP`)) / lag(`Real GDP`) * 100)) %>%
select(-`Real GDP`) %>%
hchart("line", hcaes(`Year`, `Real GDP Growth Rate`)) %>%
hc_title(text = "Portuguese Real GDP Growth Rate") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Real GDP Growth Rate [%]</b>", align="middle")) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Real GDP Growth Rate: {point.y:.1f}%"
) %>%
hc_caption(
text = "<b>Real GDP Growth Rate</b> = growth rate of real GDP calculated year by year.",
style = list(marginTop = "0px")
)
economics_rgdp <-
economics_rgdp %>%
hchart("line", hcaes(`Year`, `Real GDP`)) %>%
hc_title(text = "Portuguese Real GDP") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Real GDP [int $]</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000000) {
return (this.value/1000000000) + ' bil';
} else if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Real GDP: {point.y:,.0f} int $"
) %>%
hc_caption(
text = "<b>Real GDP</b> = value expressing the amount of goods and services that are produced and sold through markets, at a given time, adjusted for constant prices using a deflator, the yearly consumer price index.",
style = list(marginTop = "0px")
)
economics_rgdp
economics_rgdp_g_rate
economics_nom_gdp <-
economics_nom_gdp %>%
hchart("line", hcaes(`Year`, `Nominal GDP`)) %>%
hc_title(text = "Portuguese Nominal GDP") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Nominal GDP [int $]</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000000) {
return (this.value/1000000000) + ' bil';
} else if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Nominal GDP: {point.y:,.0f} int $") %>%
hc_caption(
text = "<b>Nominal GDP</b> = value expressing the amount of goods and services that are produced and sold through markets, at a given time, calculated using current prices.",
style = list(marginTop = "0px")
)
economics_nom_gdp
economics_cpi <-
economics_cpi %>%
hchart("line", hcaes(`Year`, `Consumer Price Index`)) %>%
hc_title(text = "Portuguese Consumer Price Index") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>CPI</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000000) {
return (this.value/1000000000) + ' bil';
} else if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>CPI: {point.y:.2f}") %>%
hc_caption(
text = "<b>Consumer Price Index</b> = average value of a basket containing the most largely used consumption goods and services.<br> Reference Year: 2010",
style = list(marginTop = "0px")
)
economics_cpi
economics_unemployment <-
dsets[["portugal_unemployment_rate"]] %>%
select(-Code) %>%
filter(Entity == "Portugal") %>%
rename(`Unemployment Rate` = Unemployment..total....of.total.labor.force...modeled.ILO.estimate.) %>%
hchart("line", hcaes(`Year`, `Unemployment Rate`)) %>%
hc_title(text = "Portuguese Unemployment Rate") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Unemployment Rate [%]</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Unemployment Rate: {point.y:.1f}%") %>%
hc_caption(
text = "<b>Unemployment Rate</b> = percentage of the labour force that cannot find occupation within a short time span.",
style = list(marginTop = "0px")
)
economics_unemployment
economics_inflation <-
dsets[["portugal_inflation"]] %>%
select(-Code) %>%
filter(Entity == "Portugal") %>%
rename(`Inflation Rate`= Inflation..consumer.prices..annual...) %>%
hchart("line", hcaes(`Year`, `Inflation Rate`)) %>%
hc_title(text = "Portuguese Inflation Rate") %>%
lnplot_custom(.) %>%
hc_yAxis(title=list(text="<b>Inflation Rate [%]</b>", align="middle"),
labels = list(
formatter = JS("function() {
if (this.value >= 1000000) {
return (this.value / 1000000) + ' mil';
} else if (this.value >= 1000) {
return (this.value / 1000) + ' k';
}
return this.value;
}")
)
) %>%
hc_xAxis(title=list(text="<b>Year</b>", align="middle")) %>%
hc_tooltip(.,
headerFormat = "",
pointFormat =
"<b>{point.name}</b><br>Year: {point.x:.f}<br>Inflation Rate: {point.y:.1f}%") %>%
hc_caption(
text = "<b>Inflation Rate</b> = rate of growth of a price index over time.",
style = list(marginTop = "0px")
)
economics_inflation
