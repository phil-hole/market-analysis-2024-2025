"<b>Retail Revenues</b> = individual contributions of other categories of snacks to the total market value.<br>Variations in consumer preferences shown by variations in snack category consumption.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = " mil €",
valueDecimals = 1)
temp <- clean_volume_parallel
print(temp[, "Year"], n = 20)
temp <- temp %>% filter(Year == 2024) %>%
filter(Category != Subcategory) %>%
group_by(Category) %>%
mutate(cat_total = sum(Value),
subcat_percent = (Value/cat_total)*100) %>%
ungroup() %>%
select(-Year, -Value, -cat_total) %>%
pivot_wider(names_from = Subcategory,
values_from = subcat_percent) %>%
mutate_all(~ replace(., is.na(.), 0))
temp %>%  filter(Year == 2024) %>% group_by(Category) %>%
hchart("line", hcaes(x = `Year`, y = `Indexed_Ratio`, group = Category)) %>%
hc_title(text = "Snack Categories - Demand Variation",
style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_yAxis(title = list(text = "<b>Values Indexed 2010</b>", align = "middle"),
type="linear",
lineWidth=5,
lineColor="#ecf0f1"
) %>%
hc_xAxis(title = list(text = "<b>Year</b>", align = "middle"),
lineWidth=5,
lineColor="#ecf0f1") %>%
hc_tooltip(.,
shared = TRUE,
crosshairs = TRUE,
valueDecimals = 1
) %>%
hc_colors(., c("#002D72", "#046A38", "#FFE900", "#db240c", "#000000")) %>%
hc_size(height = 420) %>%
hc_caption(
text = "<b>Indexed Quantity Demanded w.r.t Category Price Variation</b> = average price of every snack category indexed to 2010, overlaid on the volume variation of the category of study, also indexed to 2010 (black line).",
style = list(marginTop = "0px")
)
temp <- clean_volume_parallel
temp %>%  group_by(Category) %>%
hchart("line", hcaes(x = `Year`, y = `Indexed_Ratio`, group = Category)) %>%
hc_title(text = "Snack Categories - Demand Variation",
style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_yAxis(title = list(text = "<b>Values Indexed 2010</b>", align = "middle"),
type="linear",
lineWidth=5,
lineColor="#ecf0f1"
) %>%
hc_xAxis(title = list(text = "<b>Year</b>", align = "middle"),
lineWidth=5,
lineColor="#ecf0f1") %>%
hc_tooltip(.,
shared = TRUE,
crosshairs = TRUE,
valueDecimals = 1
) %>%
hc_colors(., c("#002D72", "#046A38", "#FFE900", "#db240c", "#000000")) %>%
hc_size(height = 420) %>%
hc_caption(
text = "<b>Indexed Quantity Demanded w.r.t Category Price Variation</b> = average price of every snack category indexed to 2010, overlaid on the volume variation of the category of study, also indexed to 2010 (black line).",
style = list(marginTop = "0px")
)
temp <- clean_gdp_capita_volumes
print(temp[, "Year"], n = 20)
print(temp[, "Year"], n = 20)
print(temp[,"Year"], n = 20)
print(temp[,"Year"], n = 10)
print(temp[,"Year"])
temp <- temp %>% filter(Year == 2020)
temp %>% highchart() %>%
hc_add_series(
data = temp[[1]],
type = "line",
hcaes(x = Year, y = i_tot_vol_2010),
name = "Snack Volume Variation",
tooltip =
list(
pointFormat = "<b>Volume:</b> {point.total_vol:.f} k tonnes<br>"
)
) %>%
hc_add_series(
data = temp[[2]],
type = "line",
hcaes(x = Year, y = i_gdp_capita_2010),
name = "GDP per Capita Variation",
tooltip =
list(
pointFormat = "<b>GDP per capita:</b> {point.gdp_capita:,.1f} €/inhab"
)
) %>%
hc_title(text = "Snack Consumption to Income Variation",
style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_yAxis(title = list(text = "<b>Values Indexed 2010</b>", align = "middle"),
type="linear",
lineWidth=5,
lineColor="#ecf0f1"
) %>%
hc_xAxis(title = list(text = "<b>Year</b>", align = "middle"),
lineWidth=5,
lineColor="#ecf0f1",
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value+2010);
}
}")
)
) %>%
hc_colors(., c("#db240c", "#046A38")) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Snack Consumption to Income Variation</b> = comparison between snack consumption and household average available income.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = TRUE)
highchart() %>%
hc_add_series(
data = temp[[1]],
type = "line",
hcaes(x = Year, y = i_tot_vol_2010),
name = "Snack Volume Variation",
tooltip =
list(
pointFormat = "<b>Volume:</b> {point.total_vol:.f} k tonnes<br>"
)
) %>%
hc_add_series(
data = temp[[2]],
type = "line",
hcaes(x = Year, y = i_gdp_capita_2010),
name = "GDP per Capita Variation",
tooltip =
list(
pointFormat = "<b>GDP per capita:</b> {point.gdp_capita:,.1f} €/inhab"
)
) %>%
hc_title(text = "Snack Consumption to Income Variation",
style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_yAxis(title = list(text = "<b>Values Indexed 2010</b>", align = "middle"),
type="linear",
lineWidth=5,
lineColor="#ecf0f1"
) %>%
hc_xAxis(title = list(text = "<b>Year</b>", align = "middle"),
lineWidth=5,
lineColor="#ecf0f1",
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value+2010);
}
}")
)
) %>%
hc_colors(., c("#db240c", "#046A38")) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Snack Consumption to Income Variation</b> = comparison between snack consumption and household average available income.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = TRUE)
highchart() %>%
hc_add_series(
data = temp,
type = "line",
hcaes(x = Year, y = i_tot_vol_2010),
name = "Snack Volume Variation",
tooltip =
list(
pointFormat = "<b>Volume:</b> {point.total_vol:.f} k tonnes<br>"
)
) %>%
hc_add_series(
data = temp[[2]],
type = "line",
hcaes(x = Year, y = i_gdp_capita_2010),
name = "GDP per Capita Variation",
tooltip =
list(
pointFormat = "<b>GDP per capita:</b> {point.gdp_capita:,.1f} €/inhab"
)
) %>%
hc_title(text = "Snack Consumption to Income Variation",
style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_yAxis(title = list(text = "<b>Values Indexed 2010</b>", align = "middle"),
type="linear",
lineWidth=5,
lineColor="#ecf0f1"
) %>%
hc_xAxis(title = list(text = "<b>Year</b>", align = "middle"),
lineWidth=5,
lineColor="#ecf0f1",
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value+2010);
}
}")
)
) %>%
hc_colors(., c("#db240c", "#046A38")) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Snack Consumption to Income Variation</b> = comparison between snack consumption and household average available income.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = TRUE)
temp <- clean_gdp_capita_volumes
highchart() %>%
hc_add_series(
data = temp,
type = "line",
hcaes(x = Year, y = i_tot_vol_2010),
name = "Snack Volume Variation",
tooltip =
list(
pointFormat = "<b>Volume:</b> {point.total_vol:.f} k tonnes<br>"
)
) %>%
hc_add_series(
data = temp[[2]],
type = "line",
hcaes(x = Year, y = i_gdp_capita_2010),
name = "GDP per Capita Variation",
tooltip =
list(
pointFormat = "<b>GDP per capita:</b> {point.gdp_capita:,.1f} €/inhab"
)
) %>%
hc_title(text = "Snack Consumption to Income Variation",
style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_yAxis(title = list(text = "<b>Values Indexed 2010</b>", align = "middle"),
type="linear",
lineWidth=5,
lineColor="#ecf0f1"
) %>%
hc_xAxis(title = list(text = "<b>Year</b>", align = "middle"),
lineWidth=5,
lineColor="#ecf0f1",
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value+2010);
}
}")
)
) %>%
hc_colors(., c("#db240c", "#046A38")) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Snack Consumption to Income Variation</b> = comparison between snack consumption and household average available income.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = TRUE)
temp <-
list(temp[, c("Year", "total_vol", "i_tot_vol_2010")],
temp[, c("Year", "gdp_capita", "i_gdp_capita_2010")])
highchart() %>%
hc_add_series(
data = temp[[1]],
type = "line",
hcaes(x = Year, y = i_tot_vol_2010),
name = "Snack Volume Variation",
tooltip =
list(
pointFormat = "<b>Volume:</b> {point.total_vol:.f} k tonnes<br>"
)
) %>%
hc_add_series(
data = temp[[2]],
type = "line",
hcaes(x = Year, y = i_gdp_capita_2010),
name = "GDP per Capita Variation",
tooltip =
list(
pointFormat = "<b>GDP per capita:</b> {point.gdp_capita:,.1f} €/inhab"
)
) %>%
hc_title(text = "Snack Consumption to Income Variation",
style=list(
fontWeight="bold",
fontSize= "15px",
fontFamily= "Lato"
)
) %>%
hc_yAxis(title = list(text = "<b>Values Indexed 2010</b>", align = "middle"),
type="linear",
lineWidth=5,
lineColor="#ecf0f1"
) %>%
hc_xAxis(title = list(text = "<b>Year</b>", align = "middle"),
lineWidth=5,
lineColor="#ecf0f1",
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value+2010);
}
}")
)
) %>%
hc_colors(., c("#db240c", "#046A38")) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Snack Consumption to Income Variation</b> = comparison between snack consumption and household average available income.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = TRUE)
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year)) %>%
group_by(Year) %>%
mutate(Total = sum(share_val)) %>%
ungroup(Year)
temp <-
clean_vieira_share %>%
filter(Year == 2024)
temp <-
clean_vieira_share %>%
filter(Year == input$vieira_year_slider)
hchart(temp, type = "column", hcaes(x = "Total", y = share_val, group = Category)) %>%
hc_title(text = "Vieira - Share Value [% Market Value]") %>%
hc_plotOptions(series = list(stacking = "normal")) %>%
barplot_custom(.) %>%
hc_xAxis(title = list(text = paste0(input$vieira_year_slider), align = "middle"),
labels = list(
formatter = JS("function() {
if (this.value) {
return '';
}
}")
)) %>%
hc_yAxis(title = list(text = "<b>Share Value [% Market Value]</b>", align = "middle"),
min = 0, max = 5,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(., c("#FFE900", "#046A38","#db240c",  "#002D72")) %>%
hc_size(height = 400) %>%
hc_tooltip(shared = TRUE,
headerFormat = paste0(input$vieira_year_slider, "<br>"),
valueSuffix = "%",
valueDecimals = 1)
hchart(temp, type = "column", hcaes(x = "Total", y = share_val, group = Category)) %>%
hc_title(text = "Vieira - Share Value [% Market Value]") %>%
hc_plotOptions(series = list(stacking = "normal")) %>%
barplot_custom(.) %>%
hc_xAxis(title = list(text = paste0(2024), align = "middle"),
labels = list(
formatter = JS("function() {
if (this.value) {
return '';
}
}")
)) %>%
hc_yAxis(title = list(text = "<b>Share Value [% Market Value]</b>", align = "middle"),
min = 0, max = 5,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(., c("#FFE900", "#046A38","#db240c",  "#002D72")) %>%
hc_size(height = 400) %>%
hc_tooltip(shared = TRUE,
headerFormat = paste0(input$vieira_year_slider, "<br>"),
valueSuffix = "%",
valueDecimals = 1)
hchart(temp, type = "column", hcaes(x = "Total", y = share_val, group = Category)) %>%
hc_title(text = "Vieira - Share Value [% Market Value]") %>%
hc_plotOptions(series = list(stacking = "normal")) %>%
barplot_custom(.) %>%
hc_xAxis(title = list(text = paste0(2024), align = "middle"),
labels = list(
formatter = JS("function() {
if (this.value) {
return '';
}
}")
)) %>%
hc_yAxis(title = list(text = "<b>Share Value [% Market Value]</b>", align = "middle"),
min = 0, max = 5,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(., c("#FFE900", "#046A38","#db240c",  "#002D72")) %>%
hc_size(height = 400) %>%
hc_tooltip(shared = TRUE,
headerFormat = paste0(2024, "<br>"),
valueSuffix = "%",
valueDecimals = 1)
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year)) %>%
group_by(Year) %>%
mutate(Total = sum(share_val)) %>%
ungroup(Year)
temp <- clean_vieira_share
hchart(temp, type = "column", hcaes(x = "Total", y = share_val, group = Category)) %>%
hc_title(text = "Vieira - Share Value [% Market Value]") %>%
hc_plotOptions(series = list(stacking = "normal")) %>%
barplot_custom(.) %>%
hc_xAxis(title = list(text = paste0(input$vieira_year_slider), align = "middle"),
labels = list(
formatter = JS("function() {
if (this.value) {
return '';
}
}")
)) %>%
hc_yAxis(title = list(text = "<b>Share Value [% Market Value]</b>", align = "middle"),
min = 0, max = 5,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(., c("#FFE900", "#046A38","#db240c",  "#002D72")) %>%
hc_size(height = 400) %>%
hc_tooltip(shared = TRUE,
headerFormat = paste0(input$vieira_year_slider, "<br>"),
valueSuffix = "%",
valueDecimals = 1)
hchart(temp, type = "column", hcaes(x = "Total", y = share_val, group = Category)) %>%
hc_title(text = "Vieira - Share Value [% Market Value]") %>%
hc_plotOptions(series = list(stacking = "normal")) %>%
barplot_custom(.) %>%
hc_xAxis(title = list(text = "Year", align = "middle"),
labels = list(
formatter = JS("function() {
if (this.value) {
return '';
}
}")
)) %>%
hc_yAxis(title = list(text = "<b>Share Value [% Market Value]</b>", align = "middle"),
min = 0, max = 5,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(., c("#FFE900", "#046A38","#db240c",  "#002D72")) %>%
hc_size(height = 400) %>%
hc_tooltip(shared = TRUE,
headerFormat = paste0(2, "<br>"),
valueSuffix = "%",
valueDecimals = 1)
