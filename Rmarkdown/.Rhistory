values_to = "Value")
temp <-
clean_vieira_share %>%
filter(Year == 2010) %>%
filter(Category != Subcategory) %>%
select(-Year) %>%
pivot_wider(names_from = Subcategory,
values_from = Value) %>%
mutate_all(~ replace(., is.na(.), 0))
temp <-
clean_subcategories %>%
filter(Year == 2010) %>%
filter(Category != Subcategory) %>%
select(-Year) %>%
pivot_wider(names_from = Subcategory,
values_from = Value) %>%
mutate_all(~ replace(., is.na(.), 0))
View(temp)
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year))%>%
group_by(Year)
clean_vieira_share <-
filter(Year == 2016) %>% #year slider filter here
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year))%>%
group_by(Year)
clean_vieira_share <-
filter(Year == 2016) %>% #year slider filter here
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
clean_vieira_share <-
filter(Year == 2016) %>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year))
clean_vieira_share <-
filter(Year == 2016) %>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year))
clean_vieira_share <-
filter(Year == 2016)
clean_vieira_share <-
clean_vieira_share %>%
filter(Year == 2016)%>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year))
temp <-
clean_vieira_share %>%
filter(Year == 2016)%>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
hc_data <-
lapply(
names(temp)[-1],
function(company) {
list(name = company, data = as.numeric(temp[[company]]))
}
)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
barplot_custom(.) %>%
hc_xAxis(categories = temp$Category) %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle"),
min = 0, max = 100,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5))) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = individual contributions of other categories of snacks to the total market value, expressed as percentages.<br>Variations in consumer preferences shown by variations in snack category consumption.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = "%",
valueDecimals = 1)
temp2 <-
clean_subcategories %>%
filter(Year == 2010) %>%
filter(Category != Subcategory) %>%
select(-Year) %>%
pivot_wider(names_from = Subcategory,
values_from = Value) %>%
mutate_all(~ replace(., is.na(.), 0))
View(temp2)
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year), Total = "Total")
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year), Total = "Total")
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016)%>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
hc_data <-
lapply(
names(temp)[-1],
function(company) {
list(name = company, data = as.numeric(temp[[company]]))
}
)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
barplot_custom(.) %>%
hc_xAxis(categories = temp$Category) %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle"),
min = 0, max = 100,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5))) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = individual contributions of other categories of snacks to the total market value, expressed as percentages.<br>Variations in consumer preferences shown by variations in snack category consumption.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = "%",
valueDecimals = 1)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
barplot_custom(.) %>%
hc_xAxis(categories = temp$Total) %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle"),
min = 0, max = 100,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5))) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = individual contributions of other categories of snacks to the total market value, expressed as percentages.<br>Variations in consumer preferences shown by variations in snack category consumption.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = "%",
valueDecimals = 1)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
barplot_custom(.) %>%
hc_xAxis(categories = temp$Total) %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle"),
min = 0,
labels = list(
formatter = JS("function() {
if (this.value) {
return (this.value) + '%';
}
}")
)
) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5))) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = individual contributions of other categories of snacks to the total market value, expressed as percentages.<br>Variations in consumer preferences shown by variations in snack category consumption.",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = "%",
valueDecimals = 1)
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year), Total = "Total")
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016)%>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
hc_data <-
lapply(
names(temp)[-1],
function(company) {
list(name = company, data = as.numeric(temp[[company]]))
}
)
View(hc_data)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
barplot_custom(.) %>%
hc_xAxis(categories = temp$Total) %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle")) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5)))
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data)
hc_data
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year), Total = "Total")
clean_vieira_share
glimpse(clean_vieira_share)
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year), Total = "Total")
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016)%>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
hc_data <-
lapply(
names(temp)[-1],
function(company) {
list(name = company, data = as.numeric(temp[[company]]))
}
)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
barplot_custom(.) %>%
hc_xAxis(categories = "Total") %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle")) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5)))%>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = filler",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = "%",
valueDecimals = 1)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
# barplot_custom(.) %>%
hc_xAxis(categories = "Total") %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle")) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5)))%>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = filler",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = "%",
valueDecimals = 1)
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year), Total = "Total")
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016)%>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., is.na(.), 0))
is.numeric(temp)
is.numeric(temp[-1])
is.numeric(temp[2, 2])
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016)%>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate_all(~ replace(., !is.numeric(.), as.numeric(.)))
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016)%>%
select(-Year)
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016)%>%
select(-Year) %>%
mutate(share_val = as.numeric(share_val)) %>%
pivot_wider(names_from = Category,
values_from = share_val)
is.numeric(temp[2, 2])
temp[2, 2]
temp[1, 2]
temp[, 2]
temp[1]
temp[2]
temp[4]
temp[1 ,4]
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016)%>%
select(-Year) %>%
mutate(share_val = as.numeric(share_val)) %>%
pivot_wider(names_from = Category,
values_from = share_val)
hc_data <-
lapply(
names(temp)[-1],
function(company) {
list(name = company, data = as.numeric(temp[[company]]))
}
)
View(hc_data)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
barplot_custom(.) %>%
hc_xAxis(categories = "Total") %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle")) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5)))%>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = filler",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = "%",
valueDecimals = 1)
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val),
Year = as.numeric(Year),
Total = "Total")
temp <-
clean_vieira_share[, c(4, 1, 2, 3)] %>%
filter(Year == 2016) %>%
select(-Year) %>%
pivot_wider(names_from = Category,
values_from = share_val) %>%
mutate(across(everything(), ~ replace(., is.na(.), 0)))
hc_data <-
lapply(
names(temp)[-1],
function(category) {
list(name = category, data = as.numeric(temp[[category]]))
}
)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
barplot_custom(.) %>%
hc_xAxis(categories = "Total") %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle")) %>%
hc_colors(c("#db240c","#FFE900", "#FFB900",colorRampPalette(c("#046A38", "#05fc83"))(5)))%>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = filler",
style = list(marginTop = "0px")
) %>%
hc_tooltip(shared = FALSE,
valueSuffix = "%",
valueDecimals = 1)
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Snack Categories - Retail Revenues Percentage [%]") %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
hc_xAxis(categories = "Total") %>%
hc_yAxis(title = list(text = "<b>Percentage of Total Retail Revenues [%]</b>", align = "middle")) %>%
hc_colors(c("#db240c", "#FFE900", "#FFB900", colorRampPalette(c("#046A38", "#05fc83"))(5))) %>%
hc_size(height = 400) %>%
hc_caption(
text = "<b>Retail Revenues Percentage</b> = filler",
style = list(marginTop = "0px")
) %>%
hc_tooltip(
shared = FALSE,
valueSuffix = "%",
valueDecimals = 1
)
#CLEAN DATASETS
clean_vieira_share <-
xlsx_dsets[["portugal_company_shares"]] %>%
filter(Company == "Vieira de Castro Produtos Alimentares SA") %>%
select(-Country, -Unit, -Company) %>%
pivot_longer(cols = -Category,
names_to = "Year",
values_to = "share_val") %>%
mutate(share_val = as.numeric(share_val), Year = as.numeric(Year)) %>%
group_by(Year) %>%
mutate(Total = sum(share_val)) %>%
ungroup(Year)
View(clean_vieira_share)
