#-global edits done to reduce variable names, since discarded data not required.
#-method flexible to increases, decreases or variations in order to dataset directory.
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))
View(clean_company_shares)
clean_company_shares %>% pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-")
View(clean_company_shares)
View(clean_company_shares %>% pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-"))
clean_company_shares %>% pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>% group_by(Year, Company) %>%  # Ensure grouping by both Year and Company
summarise(TotalValue = sum(Value), .groups = "drop") %>%  # Summarize values
View(.)
clean_company_shares %>% pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>% group_by(Year, Company) %>%  # Ensure grouping by both Year and Company
summarise(TotalValue = sum(Value), .groups = "drop")  # Summarize values
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))%>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value))
View(clean_company_shares)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))%>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company)
glimpse(clean_company_shares)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))%>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarize(Aggregate_Value = sum(Value, na.rm = TRUE)) %>%
pivot_wider(names_from = Company, values_from = Aggregate_Value, values_fill = 0)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))%>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarize(Aggregate_Value = sum(Value, na.rm = TRUE))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))%>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))%>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarize(Aggregate_Value = sum(Value, na.rm = TRUE))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))%>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarize(Aggregate_Value = sum(Value, na.rm = TRUE)) %>%
pivot_wider(names_from = Company, values_from = Aggregate_Value, values_fill = 0)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarize(Aggregate_Value = sum(Value, na.rm = TRUE), .groups = "drop") %>%
pivot_wider(names_from = Company, values_from = Aggregate_Value, values_fill = 0)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarize(Aggregate_Value = sum(Value, na.rm = TRUE), .groups = "drop") %>%
pivot_wider(names_from = Company, values_from = Aggregate_Value, values_fill = 0) %>%
pivot_longer(cols = -Year, names_to = "Company", values_to = "Value")
clean_employee_n <-
xlsx_dsets[["portugal_dsets_estat"]] %>%
select(Year, `Persons Employed`) %>%
filter(complete.cases(.))
View(clean_company_shares)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Year,
names_to = "Company",
values_to = "Value"
)
View(clean_company_shares)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Year,
names_to = "Company",
values_to = "Value"
) %>%
group_by(Year, Company) %>%
summarise(Sum = sum(Value))
View(clean_company_shares)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Year,
names_to = "Company",
values_to = "Value"
) %>%
group_by(Year, Company) %>%
summarise(Sum = sum(Value))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Year,
names_to = "Company",
values_to = "Value"
)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Year,
names_to = "Company",
values_to = "Value"
) %>%
group_by(Year, Company)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
group_by(Year, Company)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
group_by(Year, Company) %>%
summarise(Sum = sum(Value))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
group_by(Year, Company) %>%
summarise(Sum = sum(Value))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarize(Aggregate_Value = sum(Value, na.rm = TRUE), .groups = "drop") %>%
pivot_wider(names_from = Company, values_from = Aggregate_Value, values_fill = 0) %>%
pivot_longer(cols = -Year, names_to = "Company", values_to = "Value")
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
pivot_wider(cols = -Year,
names_from = "Company",
values_from = "Value")
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
pivot_wider(names_from = "Company",
values_from = "Value")
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
pivot_wider(names_from = "Company",
values_from = "Value") %>%
group_by(Year, Company)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarise(Value = sum(Value), .groups = "drop") %>%
pivot_wider(names_from = Company, values_from = Value, values_fill = 0)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year, Company) %>%
summarise(Value = sum(Value), .groups = "drop") %>%
pivot_wider(names_from = Company, values_from = Value, values_fill = 0)
hc_data <- lapply(names(clean_company_shares)[-1], function(company) {
list(name = company, data = as.numeric(clean_company_shares[[company]]))
})
View(hc_data)
# Highchart
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Stacked Bar Plot of Values by Year") %>%
hc_xAxis(categories = pivot_data$Year) %>%
hc_yAxis(title = list(text = "Total Value")) %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
hc_tooltip(shared = TRUE, crosshairs = TRUE)
# Highchart
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Stacked Bar Plot of Values by Year") %>%
hc_xAxis(categories = clean_company_shares$Year) %>%
hc_yAxis(title = list(text = "Total Value")) %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
hc_tooltip(shared = TRUE, crosshairs = TRUE)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
pivot_wider(names_from = Company, values_from = Value)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
pivot_wider(names_from = Company, values_from = Value)
hc_data <- lapply(names(clean_company_shares)[-1], function(company) {
list(name = company, data = as.numeric(clean_company_shares[[company]]))
})
print(hc_data)#
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-", Company != "Total") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
pivot_wider(names_from = Company, values_from = Value)
hc_data <- lapply(names(clean_company_shares)[-1], function(company) {
list(name = company, data = as.numeric(clean_company_shares[[company]]))
})
# # Highchart
highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Stacked Bar Plot of Values by Year") %>%
hc_xAxis(categories = clean_company_shares$Year) %>%
hc_yAxis(title = list(text = "Total Value")) %>%
hc_plotOptions(column = list(stacking = "normal")) %>%
hc_add_series_list(hc_data) %>%
hc_tooltip(shared = TRUE, crosshairs = TRUE)
print(hc_data)
clean_investment <-
xlsx_dsets[["portugal_dsets_estat"]] %>%
select(Year, `Investment Rate`) %>%
filter(complete.cases(.))
View(clean_investment)
xlsx_dsets[[1]]
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year) %>%
summarize(Mean_Value = mean(Value, na.rm = TRUE))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year) %>%
summarize(Mean_Value = sum(Value, na.rm = TRUE))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year) %>%
summarize(Mean_Value = mean(Value, na.rm = TRUE))
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year) %>%
summarize(Mean_Value = sum(Value, na.rm = TRUE))
View(clean_employee_n)
View(clean_company_shares)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year) %>%
summarize(Mean_Value = mean(Value, na.rm = TRUE))
View(clean_company_shares)
clean_company_shares <-
xlsx_dsets[["portugal_company_shares"]] %>%
select(-Country, -Category, -Unit) %>%
filter(complete.cases(.)) %>%
pivot_longer(cols = -Company,
names_to = "Year",
values_to = "Value"
) %>%
filter(Value != "-") %>%
mutate(Year = as.numeric(Year), Value = as.numeric(Value)) %>%
group_by(Year)
View(clean_company_shares)
